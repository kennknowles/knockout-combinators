


<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started &mdash; Claire 0.3.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/screen.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Claire 0.3.1 documentation" href="../index.html" /> 
  </head>
  <body>
   <div id="header">
     <h1 class="project-name"><a href="../index.html">Claire</a></h1>
     <div class="project-version">version 0.3.1</div>
     <div class="chapter-wrapper">
       <h2 class="chapter">              
         Getting Started
       </h2>
     </div>
   </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>This document will guide you through the basics of Claire. This is a quick
introduction, but once you finish this page you&#8217;ll know all you need to start
writing property tests for your code-base, and even integrate them with your
favourite test runner!</p>
<div class="section" id="what-is-claire">
<h2>What is Claire?<a class="headerlink" href="#what-is-claire" title="Permalink to this headline">¶</a></h2>
<p>Claire is a tool for automatically testing your code. It uses a concept known
as <strong>property-based testing</strong>, where you write high-level specifications of how
each <em>unit</em> should behave, and the tool generates the test data for you,
randomly.</p>
<p>For example:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="c1">// Addition should be commutative</span>
<span class="kd">var</span> <span class="nx">commutative_p</span> <span class="o">=</span> <span class="nx">forAll</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">Int</span> <span class="p">).</span><span class="nx">satisfy</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
                      <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">==</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">a</span>
                    <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="why-would-you-use-it">
<h2>Why would you use it?<a class="headerlink" href="#why-would-you-use-it" title="Permalink to this headline">¶</a></h2>
<p>Since Claire generates random data, the data-space your test cases cover gets
larger and larger the more you run your tests. This means that every time you
run the test cases, you have more chances of catching bugs that weren&#8217;t
previously caught, even if you don&#8217;t change anything in your code. This can
highly increase the confidence you have in a code base.</p>
<p>Claire does not proof that a code base has no bugs, instead it is a tool to
increase the test space (and thus the number of bugs you can catch), and help
you analyse the data that makes a particular test fail.</p>
<p>Besides that, Claire allows you to have high-level specifications for how your
program should behave (like <a class="reference external" href="http://en.wikipedia.org/wiki/Behavior-driven_development">BDD</a>), and potentially reduce the amount of lines
of code spent with test cases, while increasing the overall test coverage.</p>
</div>
<div class="section" id="writing-properties">
<h2>Writing properties<a class="headerlink" href="#writing-properties" title="Permalink to this headline">¶</a></h2>
<p>As said before, Claire uses <strong>Properties</strong> to describe the behaviour of an unit
of code (a module, a function, etc.). These properties are described by
JavaScript functions, and define what the expected behaviour is for a given set
of data.</p>
<p>Let&#8217;s go back to the previous example of commutative property for
addition. This property says that no matter which order addition is performed,
the result should always be the same, and it is encoded in Claire like this:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">claire</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;claire&#39;</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">_</span>      <span class="o">=</span> <span class="nx">claire</span><span class="p">.</span><span class="nx">data</span>
<span class="kd">var</span> <span class="nx">forAll</span> <span class="o">=</span> <span class="nx">claire</span><span class="p">.</span><span class="nx">forAll</span>

<span class="kd">var</span> <span class="nx">commutative_p</span> <span class="o">=</span> <span class="nx">forAll</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">Int</span> <span class="p">).</span><span class="nx">satisfy</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
                      <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">==</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">a</span>
                    <span class="p">})</span>
</pre></div>
</div>
<p>In plain English, that means:</p>
<blockquote>
<div>For all pairs of integers (as <tt class="docutils literal"><span class="pre">a</span></tt> and <tt class="docutils literal"><span class="pre">b</span></tt>), the sum of these integers
yields the same result, regardless of the order in which it&#8217;s performed.</div></blockquote>
<p>Now, <tt class="docutils literal"><span class="pre">forAll</span></tt> is a function that takes some <em>data generators</em> and returns a
<tt class="docutils literal"><span class="pre">Property</span></tt> object. This object knows how to randomly generate the test data
and check if the property holds for that data. You can check if the property
holds for one case by using the <tt class="docutils literal"><span class="pre">asTest</span></tt> method.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are lots of built-in test generators for Claire. The usual data types
are there: <tt class="docutils literal"><span class="pre">Int</span></tt>, <tt class="docutils literal"><span class="pre">Num</span></tt>, <tt class="docutils literal"><span class="pre">Bool</span></tt>, <tt class="docutils literal"><span class="pre">Array(x)</span></tt> and <tt class="docutils literal"><span class="pre">Object(x)</span></tt>. You
can always look at the <tt class="docutils literal"><span class="pre">data.ls</span></tt> source to see all the built-in ones.</p>
</div>
<p>The <tt class="docutils literal"><span class="pre">asTest</span></tt> returns a function that can be used within any test runner that
depends on exceptions: which would likely be all of them. It logs the result if
the test succeeds (in verbose mode), and throws an error if it fails. So, let&#8217;s
use it:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="nx">commutative_p</span><span class="p">.</span><span class="nx">asTest</span><span class="p">({</span> <span class="nx">verbose</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">times</span><span class="o">:</span> <span class="mi">100</span> <span class="p">})()</span>
<span class="c1">// + OK passed 100 tests.</span>
</pre></div>
</div>
<p>So, it tells us that Claire ran 100 tests for the property and all of them
passed. But what if it had failed? Well, let&#8217;s see another property:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">identity_p</span> <span class="o">=</span> <span class="nx">forAll</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">).</span><span class="nx">satisfy</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
                   <span class="k">return</span> <span class="nx">a</span> <span class="o">==</span> <span class="nx">a</span> <span class="o">+</span> <span class="mi">1</span>
                 <span class="p">})</span>

<span class="nx">identity_p</span><span class="p">.</span><span class="nx">asTest</span><span class="p">({</span> <span class="nx">verbose</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">times</span><span class="o">:</span> <span class="mi">100</span> <span class="p">})()</span>
<span class="c1">// &lt;property failed&gt;: ! Falsified after 1 tests, 1 failed.</span>
<span class="c1">//</span>
<span class="c1">// : Failure #1 --------------------</span>
<span class="c1">//</span>
<span class="c1">//</span>
<span class="c1">// : The following arguments were provided:</span>
<span class="c1">//   0 - 93 (&lt;int&gt;)</span>
<span class="c1">//</span>
<span class="c1">// (Stack trace)</span>
</pre></div>
</div>
<p>Now, it does tell us pretty loudly that the property didn&#8217;t held. And that it
failed in the very first test too! It also provides information about which
arguments were given to the property, and a stack trace, which we can ignore
for now.</p>
<p>So, Claire says that the <tt class="docutils literal"><span class="pre">identity_p</span></tt> property failed for the integer
<tt class="docutils literal"><span class="pre">93</span></tt>. If we analyse the property again, we&#8217;ll see that it specifies that the
the sum of any integer with 1 equals that same integer. This is clearly not the
case for addition, as <tt class="docutils literal"><span class="pre">94</span></tt> does not equal <tt class="docutils literal"><span class="pre">93</span></tt>. If we fix that and run the
property again, we&#8217;ll get a success:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">identity_p</span> <span class="o">=</span> <span class="nx">forAll</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">).</span><span class="nx">satisfy</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
                   <span class="k">return</span> <span class="nx">a</span> <span class="o">==</span> <span class="nx">a</span> <span class="o">+</span> <span class="mi">0</span>
                 <span class="p">})</span>

<span class="nx">identity_p</span><span class="p">.</span><span class="nx">asTest</span><span class="p">({</span> <span class="nx">verbose</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">times</span><span class="o">:</span> <span class="mi">100</span> <span class="p">})()</span>
<span class="c1">// + OK passed 100 tests.</span>
</pre></div>
</div>
</div>
<div class="section" id="conditional-tests">
<h2>Conditional tests<a class="headerlink" href="#conditional-tests" title="Permalink to this headline">¶</a></h2>
<p>Some properties only hold for a given data subset. For example:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">sqrt_p</span> <span class="o">=</span> <span class="nx">forAll</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">).</span><span class="nx">satisfy</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">a</span> <span class="o">*</span> <span class="nx">a</span><span class="p">)</span> <span class="o">==</span> <span class="nx">a</span>
             <span class="p">})</span>

<span class="nx">sqrt_p</span><span class="p">.</span><span class="nx">asTest</span><span class="p">()()</span>
<span class="c1">// &lt;property failed&gt;: ! Falsified after 2 tests, 1 failed.</span>
<span class="c1">//</span>
<span class="c1">// : Failure #1 --------------------</span>
<span class="c1">//</span>
<span class="c1">//</span>
<span class="c1">// : The following arguments were provided:</span>
<span class="c1">//   0 - -11 (&lt;int&gt;)</span>
</pre></div>
</div>
<p>So, quite unsurprisingly, negative numbers don&#8217;t work with this property, but
the <tt class="docutils literal"><span class="pre">Int</span></tt> generator gives you both positive and negative numbers. So, instead
of writing a new generator, Claire allows you to define a <strong>conditional
property</strong>:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">sqrt_p</span> <span class="o">=</span> <span class="nx">forAll</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">)</span>
             <span class="p">.</span><span class="nx">given</span><span class="p">(</span>  <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">})</span>
             <span class="p">.</span><span class="nx">satisfy</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span> <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">a</span> <span class="o">*</span> <span class="nx">a</span><span class="p">)</span> <span class="o">==</span> <span class="nx">a</span> <span class="p">})</span>

<span class="nx">sqrt_p</span><span class="p">.</span><span class="nx">asTest</span><span class="p">({</span> <span class="nx">verbose</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})()</span>
<span class="c1">// + OK passed 100 tests. 124 (55%) tests ignored.</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">given</span></tt> method allows you to specify the subset of data that a property
applies to. You get the same arguments as the <tt class="docutils literal"><span class="pre">satisfy</span></tt> method, and return a
<tt class="docutils literal"><span class="pre">Boolean</span></tt> indicating whether to test the property for the generated data or
not.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Claire does provide the <tt class="docutils literal"><span class="pre">Positive</span></tt> and <tt class="docutils literal"><span class="pre">Negative</span></tt> generators, which
produce only positive and negative numbers, respectively.</p>
</div>
<p>Now it tells you that the property succeeded for 100 test cases, but a large
number of test cases (124, or 55%) were ignored. You can decide whether this is
an indication to doubt a property or not, in which case you can try running
more tests:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="nx">sqrt_p</span><span class="p">.</span><span class="nx">asTest</span><span class="p">({</span> <span class="nx">verbose</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">times</span><span class="o">:</span> <span class="mi">1000</span> <span class="p">})()</span>
<span class="c1">// &lt;property abandoned&gt;: ? Aborted after 1956 tests. 1001 (51%) tests ignored.</span>
</pre></div>
</div>
<p>If too many tests are ignored, Claire might decide to stop testing so you can
review the generators and conditions in a property.</p>
</div>
<div class="section" id="analysing-test-results">
<h2>Analysing test results<a class="headerlink" href="#analysing-test-results" title="Permalink to this headline">¶</a></h2>
<p>Of course, not all your properties will be as simple as the addition
properties, so you need better tools to analyse the test results and decide if
they are trustworthy or not, and assess why they&#8217;re failing.</p>
<p>For this, Claire allows you to <em>classify</em> the generated test cases, so you can
analyse which test data has been tested by the property. This is done by the
<tt class="docutils literal"><span class="pre">classify</span></tt> method:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">sorted</span><span class="p">(</span><span class="nx">xs</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">xs</span><span class="p">.</span><span class="nx">slice</span><span class="p">()</span>
           <span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">){</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span> <span class="p">})</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">sorted_p</span> <span class="o">=</span> <span class="nx">forAll</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nb">Array</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">)</span> <span class="p">)</span>
               <span class="p">.</span><span class="nx">satisfy</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">xs</span><span class="p">)</span> <span class="p">{</span>
                 <span class="nx">xs</span> <span class="o">=</span> <span class="nx">sorted</span><span class="p">(</span><span class="nx">xs</span><span class="p">)</span>
                 <span class="k">return</span> <span class="nx">xs</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
                                   <span class="k">return</span> <span class="nx">i</span> <span class="o">==</span> <span class="mi">0</span>
                                       <span class="o">||</span> <span class="nx">a</span> <span class="o">&gt;=</span> <span class="nx">xs</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                                <span class="p">})</span>
               <span class="p">})</span>
               <span class="p">.</span><span class="nx">classify</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">xs</span><span class="p">)</span> <span class="p">{</span>
                 <span class="k">return</span> <span class="nx">xs</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="o">?</span>  <span class="s1">&#39;empty&#39;</span>
                      <span class="o">:</span> <span class="nx">xs</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">1</span><span class="o">?</span>  <span class="s1">&#39;trivial&#39;</span>
                      <span class="o">:</span>                  <span class="s1">&#39;&gt; 1&#39;</span>
               <span class="p">})</span>

<span class="nx">sorted_p</span><span class="p">.</span><span class="nx">asTest</span><span class="p">({</span> <span class="nx">verbose</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})()</span>
<span class="c1">//  + OK passed 100 tests.</span>
<span class="c1">//  &gt; Collected test data:</span>
<span class="c1">//      o 98% - &gt; 1</span>
<span class="c1">//      o 1% - trivial</span>
<span class="c1">//      o 1% - empty</span>
</pre></div>
</div>
<p>While sorting lists with one or no elements are trivial (it&#8217;s already sorted!),
you can see that the majority of the data given (98%) passes the test. This is
a good indication that the property is likely to be trustworthy, and you can
keep running test cases to increase the confidence in the property:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="nx">sorted_p</span><span class="p">.</span><span class="nx">asTest</span><span class="p">({</span> <span class="nx">verbose</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">times</span><span class="o">:</span> <span class="mi">10000</span> <span class="p">})()</span>
<span class="c1">//  + OK passed 10000 tests.</span>
<span class="c1">//  &gt; Collected test data:</span>
<span class="c1">//      o 98% - &gt; 1</span>
<span class="c1">//      o 1% - trivial</span>
<span class="c1">//      o 1% - empty</span>
</pre></div>
</div>
</div>
<div class="section" id="integrating-with-a-test-runner">
<h2>Integrating with a test runner<a class="headerlink" href="#integrating-with-a-test-runner" title="Permalink to this headline">¶</a></h2>
<p>Assuming your test runner takes a function and expects that function to throw
an exception if the test goes wrong, you can just use the <tt class="docutils literal"><span class="pre">asTest</span></tt> method of
the <tt class="docutils literal"><span class="pre">Property</span></tt> object to integrate with the test runner. For example, this
would work on Mocha:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;Addition&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;Should be commutative&#39;</span><span class="p">,</span> <span class="nx">forAll</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">Int</span><span class="p">).</span><span class="nx">satisfy</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">==</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">a</span>
                              <span class="p">}.</span><span class="nx">asTest</span><span class="p">())</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="where-to-go-from-here">
<h2>Where to go from here?<a class="headerlink" href="#where-to-go-from-here" title="Permalink to this headline">¶</a></h2>
<p>Now that you get the idea behind Claire, you can start writing your properties
to test the behaviours in your code bases. Be sure to check the <a class="reference internal" href="../user/index.html"><em>Discover
Claire</em></a> documentation to learn everything you can get from the
library.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
    <form class="search"
          action="../search.html"
          method="get">
      <input type="text" name="q" size="18" 
             placeholder="Search the docs..." />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

<div id="toc">
  <ul>
<li><a class="reference internal" href="#">Getting Started</a><ul>
<li><a class="reference internal" href="#what-is-claire">What is Claire?</a></li>
<li><a class="reference internal" href="#why-would-you-use-it">Why would you use it?</a></li>
<li><a class="reference internal" href="#writing-properties">Writing properties</a></li>
<li><a class="reference internal" href="#conditional-tests">Conditional tests</a></li>
<li><a class="reference internal" href="#analysing-test-results">Analysing test results</a></li>
<li><a class="reference internal" href="#integrating-with-a-test-runner">Integrating with a test runner</a></li>
<li><a class="reference internal" href="#where-to-go-from-here">Where to go from here?</a></li>
</ul>
</li>
</ul>

</div>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
 <div id="footer">
   <ul class="panel-links">
     <li>
       <a href="../index.html" accesskey="H">Home</a>
     </li>
     <li>
       <a href="../search.html" accesskey="S">Search</a>
     </li>
     <li>
       <a href="../genindex.html" accesskey="I">Index</a>
     </li>
     
     
     <li>
       <a href="../_sources/quickstart/index.txt"
          rel="nofollow">Source</a>
     </li>
     
     
   </ul>
   <div class="copyright">
     <span class="copy-info">
       
         &copy; 2013, Quildreen &#34;Sorella&#34; Motta
       
     </span>
     <span class="gen-info">
       
         Hacked on <a href="https://github.com/killdream/caffeine-theme">C<sub>8</sub>H<sub>10</sub>N<sub>4</sub>O<sub>2</sub></a> + <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3
       
     </span>
   </div>
 </div>

<script>
void function($) {
  var sidebar   = $('.sphinxsidebar')
  var sidebar_y = sidebar.offset().top
  var breath    = $('#footer').height() * 2 + 20
  var toc       = []


  // Maps a reference to a (referedOffset, referee) tuple
  // with_distance :: jQuery -> [Number, jQuery]
  function with_distance(e) {
    return { offset: $($(e).attr('href')).offset().top
           , item:   $(e) } }

  // Highlights the current active topic, based on the given offset
  // highlight_current_topic :: [(Number, jQuery)], Number -> ()
  function highlight_current_topic(topics, offset) {
    var active = topics[0]?  topics[0].item : $()
    topics.forEach(function(e){ e.item.removeClass('active') })
    topics.every(function(e) {
      if (e.offset <= offset)  return active = e.item  })
    active.addClass('active') }

  // Normalises the sidebar positioning for readability depending on the offset
  // normalise_sidebar :: Number, Number, Number -> ()
  function normalise_sidebar(offset, height, breath) {
    if (offset > sidebar_y)
      sidebar.css({ position: 'fixed'
                  , top: '10px'
                  , height: height - breath
                  , width: '210px' })
    else
      sidebar.css({ position: 'static'
                  , top: 'auto'
                  , height: 'auto'
                  , width: '200px' })}
                      

  $(window).bind('scroll', function() {
    normalise_sidebar(window.scrollY, window.innerHeight, breath)
    highlight_current_topic(toc, window.scrollY)
  })

  $(window).bind('resize', function() {
    if (sidebar.css('position') == 'fixed')
      sidebar.height(window.innerHeight - breath)
  })

  $(window).bind('load', function() {
    toc = $('.sphinxsidebar #toc ul ul a.reference.internal').toArray()
                                                             .map(with_distance) })

}(jQuery)
</script>

  </body>
</html>